!function(t){var e={};function i(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([,function(t,e){class i{constructor(t){this.socket=t,this.isAssigned=!1,this.isTyping=!1,this.volunteerIsTyping=!1,this.volume=!0,this.chatDisabled=!1}openChat(){if(this.chatDisabled)return;const t=a();$("#welcome-time").text(t),$("#chat-container").css("display","block"),$("#open-chat-button").css("display","none")}closeChat(){$("#chat-container").css("display","none"),$("#open-chat-button").css("display","block"),location.reload()}minimizeChat(){this.chatDisabled||($("#chat-container").animate({height:"40px"},200),$("#chat-body").animate({height:"0px"},200),$("#chat-header i.fa-chevron-down").css("display","none"),$("#chat-header i.fa-chevron-up").css("display","initial"))}maximizeChat(){this.chatDisabled||($("#chat-container").animate({height:"540px"},200),$("#chat-body").animate({height:"500px"},200),$("#chat-header i.fa-chevron-up").css("display","none"),$("#chat-header i.fa-chevron-down").css("display","initial"))}openAdvancedMenu(){this.isAssigned&&!this.chatDisabled&&($("#chat-container > #chat-body > #chat-content").animate({height:"340px"},200),$("#menu-container").css("display","block"),$("#chat-form .fa-plus").css("display","none"),$("#chat-form .fa-times").css("display","initial"),$("#chat-content").animate({scrollTop:$("#chat-main").prop("scrollHeight")},1e3))}closeAdvancedMenu(){$("#chat-container > #chat-body > #chat-content").animate({height:"460px"},200),setTimeout(()=>{$("#menu-container").css("display","none"),$("#chat-form .fa-plus").css("display","initial"),$("#chat-form .fa-times").css("display","none")},150)}sendMessage(){if(!this.isAssigned||this.chatDisabled)return;const t=$("#chat-message").val();this.socket&&t&&(this.socket.emit("out chat message",t),$("#chat-message").val(""))}chatStarted(){this.isAssigned=!0,this.playIncomingMsgSound();const t=a();$("#chat-start-time").text(t),$("#chat-main .chat-started-text").css("display","block"),$("#chat-form .fa-plus").addClass("pointer"),$("#chat-form .fa-arrow-right").addClass("pointer"),$("#header-text").text(""+i18next.t("vol"))}chatEnded(){this.chatDisabled=!0,$("#chat-container > #chat-ended-overlay").css("display","initial")}addMessage(t,e){if(this.chatDisabled)return;this.volume&&"in"==e&&this.playIncomingMsgSound();let i="in"==e?""+i18next.t("vol"):""+i18next.t("me"),n="in"==e?"time-in":"time-out";const s=a();$("#chat-history").append($("<li class="+n+"></li>").text(`${i} ${s}`)),$("#chat-history").append($("<li class="+e+"></li>").text(t)),$("#chat-content").animate({scrollTop:$("#chat-main").prop("scrollHeight")},1e3)}sendTypingEvent(){this.chatDisabled||this.isAssigned&&!this.isTyping&&(this.isTyping=!0,this.socket.emit("user is typing","typing"),setTimeout(()=>this.isTyping=!1,3e3))}showTypingMessage(){this.chatDisabled||this.isAssigned&&!this.volunteerIsTyping&&(this.volunteerIsTyping=!0,$("#waiting-msg").css("visibility","visible"),setTimeout(()=>{this.volunteerIsTyping=!1,$("#waiting-msg").css("visibility","hidden")},3e3))}toggleVolume(){this.chatDisabled||(this.volume=!this.volume,this.volume?($("#menu-volume .fa-volume-off").css("display","inline-block"),$("#menu-volume .fa-volume-up").css("display","none"),$("#menu-volume p").text(""+i18next.t("mute-notifications"))):($("#menu-volume .fa-volume-off").css("display","none"),$("#menu-volume .fa-volume-up").css("display","inline-block"),$("#menu-volume p").text(""+i18next.t("turn-on-notifications"))))}playIncomingMsgSound(){document.getElementById("sound").innerHTML='<audio autoplay="autoplay"><source src="http://localhost:3000/audio/when.mp3" type="audio/mpeg"><source src="http://localhost:3000/audio/when.ogg" type="audio/ogg"><embed hidden="true" autostart="true" loop="false" src="audio/when.mp3"></audio>'}}function a(){return(new Date).toLocaleString("he-IL",{timeZone:"Asia/Jerusalem",hour:"2-digit",minute:"2-digit",day:"2-digit",month:"2-digit"})}document.getElementById("open-chat-button").onclick=()=>{i18next.use(i18nextXHRBackend).init({backend:{loadPath:"http://localhost:3000/langs/he.json",crossDomain:!0}},(function(t,e){!function(){const t=`<div id="chat-container" class="none fixed"><div id="sound"></div><section id="chat-ended-overlay" class="chat-overlay none full-width"><div id="chat-ended-button"><p>${i18next.t("conversation-ended")}<br>\n                        ${i18next.t("click-to-close-chat")}</p></div></section><section id="chat-header" class="full-width"><div class="flex"><i class="fa fa-comment-o white"></i><p id="header-text" class="rtl">${i18next.t("connecting")}</p></div><div><i class="fa fa-chevron-down pointer white"></i><i class="fa fa-chevron-up pointer white"></i><i class="fa fa-times pointer white"></i></div></section><section id="chat-body"><section id="chat-content"><div id="chat-main" class="rtl"><span id="welcome-time" class="time-general"></span><p>${i18next.t("closing-chat-erase-messages")}.<br><br>${i18next.t("reopen-chat-starts-with-new-vol")}.</p><br><p>${i18next.t("one-of-our-vols-will-be-with-you-shortly")}.<br></p><span id="chat-start-time" class="chat-started-text time-general"></span><p class="chat-started-text">${i18next.t("hello-im-vol-from-the-help-center-you-can-start-typing")}</p><ul id="chat-history"></ul></div><div id="waiting-msg"><p>${i18next.t("vol-is-typing")}</p></div></section><section id="chat-message-container" class="full-width"><form action="#" id="chat-form" class="flex"><i class="fa fa-plus fa-lg button-color-disabled"></i><i class="fa fa-times fa-lg pointer button-color-enabled none"></i><input id="chat-message" class="rtl" autocomplete="off" placeholder="${i18next.t("type-text-here")}""/><i class="fa fa-arrow-right fa-lg button-color-disabled""></i></form></section><section id="menu-container" class="none"><div id="menu-content" class="flex"><article id="menu-end-conversation"><div><i class="fa fa-ban fa-lg"></i></div><p>${i18next.t("end-conversation")}</p></article><article id="menu-volume"><div><i class="fa fa-volume-off fa-lg"></i><i class="fa fa-volume-up fa-lg none"></i></div><p>${i18next.t("mute-notifications")}</p></article></div><div id="menu-footer"><article></article></div></section></section></div>`;document.getElementById("discreetly-chat-widget-container").innerHTML=t}(),function(){const t=io("http://localhost:3000",{reconnection:!1,pingTimeout:3e5});t.on("disconnect",()=>{chat.chatEnded()}),chat=new i(t),chat.openChat(),$("#chat-header .fa-times").click(()=>{chat.closeChat()}),$("#chat-header .fa-chevron-down").click(()=>{chat.minimizeChat()}),$("#chat-header .fa-chevron-up").click(()=>{chat.maximizeChat()}),$("#chat-form .fa-arrow-right").click(()=>{chat.sendMessage()}),$("#chat-form .fa-plus").click(()=>{chat.openAdvancedMenu()}),$("#chat-form .fa-times").click(()=>{chat.closeAdvancedMenu()}),$("#chat-ended-overlay #chat-ended-button").click(()=>{chat.closeChat()}),$("#menu-end-conversation").click(()=>{chat.chatEnded()}),$("#menu-send-email").click(()=>{console.log("menu-send-email")}),$("#menu-print-chat").click(()=>{console.log("menu-print-chat")}),$("#menu-volume").click(()=>{chat.toggleVolume()}),$("input#chat-message").on("input",(function(){chat.sendTypingEvent()})),$("#chat-form").submit(t=>(chat.sendMessage(),t.preventDefault(),!1)),chat.socket.on("out chat message",t=>{chat.addMessage(t,"out")}),chat.socket.on("in chat message",t=>{chat.addMessage(t,"in")}),chat.socket.on("chat started",t=>{chat.chatStarted()}),chat.socket.on("chat ended",t=>{chat.chatEnded()}),chat.socket.on("volunteer is typing",t=>{chat.showTypingMessage()})}()}))}}]);